---
import Base from '../../layouts/BaseLayout.astro'
import { getCollection, render } from 'astro:content'

export async function getStaticPaths() {
  const posts = await getCollection('blog', ({data}) => !data.draft)
  console.log('[paths] posts count =', posts.length)   // 调试：构建时能看到数量
  return posts.map(p => ({ params: { slug: p.slug }, props: p }))
}

const post = Astro.props
const { Content } = await render(post)
---
<Base>
  <article>
    <h1>{post.data.title}</h1>
    <Content />
  </article>
</Base>
